apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  generateName: my-pipeline-
spec:
  tasks:
  - name: mytask
    taskSpec:
      steps:
      - uses:
          git: jenkins-x/jx3-pipeline-catalog/tasks/go/release.yaml@HEAD
          step: jx-variables
        env:
          - name: MY_NEW_ENV_VAR
            value: this-is-a-new-value
      - uses:
          git: jenkins-x/jx3-pipeline-catalog/tasks/go/release.yaml@HEAD
          step: build-make-build
        script: |
          #!/usr/bin/env sh
          echo "this is my custom script"
        workingDir: /workspace/mynewdir
      - uses:
          git: jenkins-x/jx3-pipeline-catalog/tasks/go/release.yaml@HEAD
          step: build-container-build
        command:
          - bash
        args:
          - -c
          - "echo this is a new custom command"
      - uses:
          git: jenkins-x/jx3-pipeline-catalog/tasks/go/release.yaml@HEAD
          step: promote-changelog
        envFrom:
          - configMapRef:
              name: myconfigmap
              optional: true
      - uses:
          git: jenkins-x/jx3-pipeline-catalog/tasks/go/release.yaml@HEAD
          step: promote-jx-promote
        volumeMounts:
          - mountPath: /foo/bar
            name: my-new-volume

